<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Key Access</title>
    <style>/* Gi·ªØ nguy√™n CSS c≈© */</style>
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <!-- Gi·ªØ nguy√™n giao di·ªán c≈© -->
            <div id="content">
                <div class="loading">üîÑ ƒêang x√°c th·ª±c...</div>
            </div>
        </div>
    </div>

    <script>
        // === ANTI-HOOK PROTECTION ===
        (function() {
            // Ph√°t hi·ªán proxy/debugger
            if (window.Proxy && Proxy.toString().includes('native')) {
                const startTime = Date.now();
                debugger;
                if (Date.now() - startTime > 100) {
                    document.body.innerHTML = '<h1 style="color:red;text-align:center;">Security Violation Detected</h1>';
                    return;
                }
            }
            
            // Override fetch ƒë·ªÉ ch·∫∑n inspection
            const originalFetch = window.fetch;
            window.fetch = function(...args) {
                const stack = new Error().stack;
                if (stack.includes('debugger') || stack.includes('console')) {
                    return Promise.reject(new Error('Security violation'));
                }
                return originalFetch.apply(this, args);
            };
        })();

        // === MAIN LOGIC ===
        async function secureInit() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const sessionToken = urlParams.get('session');
                
                if (!sessionToken) {
                    showError('Invalid access');
                    return;
                }
                
                // G·ªçi API v·ªõi session token
                const response = await fetch(`https://your-worker.workers.dev?session=${sessionToken}`, {
                    method: 'GET',
                    headers: {
                        'User-Agent': navigator.userAgent,
                        'X-Client-Fingerprint': await generateFingerprint()
                    }
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    const decrypted = await decryptData(result.data, sessionToken);
                    showKey(decrypted);
                } else {
                    showError('Access denied');
                }
                
            } catch (error) {
                showError('Security error');
            }
        }

        async function generateFingerprint() {
            // T·∫°o fingerprint ph·ª©c t·∫°p
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.textBaseline = 'top';
            ctx.font = '14px Arial';
            ctx.fillText('security-fingerprint', 2, 2);
            return btoa(canvas.toDataURL());
        }

        async function decryptData(encryptedData, key) {
            try {
                const combined = Uint8Array.from(atob(encryptedData), c => c.charCodeAt(0));
                const iv = combined.slice(0, 12);
                const encrypted = combined.slice(12);
                
                const cryptoKey = await crypto.subtle.importKey(
                    'raw',
                    new TextEncoder().encode(key.slice(0, 32)),
                    { name: 'AES-GCM' },
                    false,
                    ['decrypt']
                );
                
                const decrypted = await crypto.subtle.decrypt(
                    { name: 'AES-GCM', iv },
                    cryptoKey,
                    encrypted
                );
                
                return new TextDecoder().decode(decrypted);
            } catch (e) {
                throw new Error('Decryption failed');
            }
        }

        function showKey(key) {
            document.getElementById('content').innerHTML = `
                <div class="key-section">
                    <div class="key-label">üîë Key:</div>
                    <div class="key-value">${key}</div>
                    <button onclick="copyKey('${key}')">Copy</button>
                </div>
            `;
        }

        function showError(message) {
            document.getElementById('content').innerHTML = `
                <div class="no-key">
                    <h3>${message}</h3>
                    <p>Vui l√≤ng truy c·∫≠p t·ª´ tool ch√≠nh th·ª©c</p>
                </div>
            `;
        }

        // T·ª± ƒë·ªông ch·∫°y
        secureInit();
    </script>
</body>
</html>
